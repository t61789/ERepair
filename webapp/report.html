<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>设备报修</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">

    <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->

    <script src="https://cdn.staticfile.org/vue/2.4.2/vue.min.js"></script>
    <script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
        let vue;
        window.onload = function () {
            vue = new Vue({
                el: '#app',
                data: {
                    billList: []
                },
                methods: {
                    send: function (url, data, suc) {
                        $.ajax({
                            type: "POST",
                            url: url,
                            dataType: "json",
                            contentType: 'application/json',
                            data: JSON.stringify(data),
                            success: function (msg) {
                                if (suc != null)
                                    suc(msg);
                            }
                        });
                    },
                    askRepairCheck: function () {
                        this.send("askRepairCheck", null, function (msg) {
                            for (row in msg.bills) {

                                if (msg.bills[row].state === 0)
                                    msg.bills[row].stateStr = "报修";
                                else if (msg.bills[row].state === 1)
                                    msg.bills[row].stateStr = "受理";
                                else
                                    msg.bills[row].stateStr = "完成";
                            }
                            vue.billList = msg.bills;
                        });
                    }
                }
            });

            vue.askRepairCheck();
        };
    </script>
</head>
<body>
    <div id="app">
        <button class="btn btn-default">设备报修</button>
        <table class="table table-bordered">
            <tr><td>#</td><td>报修单号</td><td>楼栋号</td><td>楼层</td><td>设备名称</td><td>报修人</td><td>备注</td><td>图片</td><td>具体位置</td><td>状态</td><td>报修时间</td></tr>
            <tr v-for="bill in billList">
                <td></td>
                <td>{{bill.billId}}</td>
                <td>{{bill.building}}号楼</td>
                <td>{{bill.floor}}层</td>
                <td>{{bill.equipmentName}}</td>
                <td>{{bill.askRepairName}}</td>
                <td>{{bill.remark}}</td>
                <td>{{bill.imgURL}}</td>
                <td>{{bill.position}}</td>
                <td>{{bill.stateStr}}</td>
                <td>{{bill.askDate}}</td>
            </tr>
        </table>
    </div>
</body>
</html>